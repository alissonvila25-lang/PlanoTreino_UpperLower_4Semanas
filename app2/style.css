* { box-sizing: border-box; }
:root {
  --bg: #0b1212; --text: #e7ecef; --muted: #93a1a1; --card: #121a1a; --border: #203030;
  --accent: #0f766e; --danger: #b91c1c;
}
html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif; }
.light { --bg: #f7fafb; --text: #101314; --muted: #475569; --card: #ffffff; --border: #d1d5db; --accent: #0f766e; }
.topbar { padding: 12px; border-bottom: 1px solid var(--border); display: grid; gap: 8px; }
.topbar h1 { margin: 0; font-size: 18px; }
.controls { display: flex; gap: 12px; align-items: center; }
.chip { background: transparent; border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 20px; cursor: pointer; }
.chip { min-height: 32px; transition: background-color .15s ease, border-color .15s ease, color .15s ease; }
.chip:hover { border-color: var(--accent); }
.chip.timer-running { background: var(--accent); border-color: var(--accent); color: #fff; }
.tabs { display: flex; gap: 8px; flex-wrap: wrap; }
.tab-btn { background: transparent; border: 1px solid var(--border); color: var(--text); padding: 6px 10px; border-radius: 8px; cursor: pointer; }
.tab-btn.is-active { background: var(--accent); border-color: var(--accent); }
main { padding: 16px; max-width: 960px; margin: 0 auto; }
.tab { display: none; }
.tab.is-active { display: block; }
.card { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 12px; margin: 10px 0; }
.ex-header { display: flex; gap: 10px; align-items: center; }
.ex-title h3 { margin: 0; font-size: 16px; }
.meta { display: grid; gap: 8px; font-size: 13px; line-height: 1.35; color: var(--muted); }
.meta .badge { margin-left: 6px; }
.stage { display: grid; gap: 8px; margin: 8px 0; }
.stage-row { display: flex; gap: 8px; align-items: center; }
.stage-row { flex-wrap: wrap; }
.stage-row-inline { flex-wrap: nowrap; }
.stage-row .hint { flex: 1 1 180px; }
.stage-row .btn { flex: 0 0 auto; min-width: 140px; }
.stage-row .btn { text-align: center; }
.stage-actions { display: flex; gap: 6px; align-items: center; flex-wrap: wrap; }
.stage-actions .btn { white-space: normal; min-width: 160px; }
.stage-row-inline .btn { min-width: 140px; }
.actions-inline { display: flex; gap: 6px; align-items: center; flex: 0 0 auto; }
.actions-inline .btn { white-space: normal; }
.stage-row-inline .hint { flex: 1 1 auto; }
@media (max-width: 768px) {
  .stage-row { gap: 6px; }
  .stage-row .hint { flex: 1 1 100%; }
  .stage-row .btn { padding: 10px 14px; font-size: 15px; min-width: 140px; }
  .stage-row-inline .hint { flex: 1 1 auto; }
  .stage-actions .btn { min-width: 140px; }
}
/* Ultra-small screens: keep inline by tightening spacing */
@media (max-width: 380px) {
  .stage-row { gap: 4px; }
  .stage-row-inline { flex-wrap: nowrap; }
  .stage-row-inline .hint { flex: 1 1 0; min-width: 0; }
  .stage-row .btn { min-width: 128px; padding: 8px 12px; font-size: 14px; }
  .actions-inline { gap: 4px; }
  .stage-row-inline .btn { min-width: 128px; }
  .stage-actions { gap: 4px; }
  .stage-actions .btn { min-width: 140px; }
}
.hint { font-size: 12px; color: var(--muted); }
.inputs { display: grid; gap: 10px; margin-top: 8px; }
.inputs-compact { grid-template-columns: 1fr 1fr; gap: 8px; }
.inputs-compact .input label { font-weight: 600; }
.inputs-compact .input input { padding: 6px; font-size: 14px; }
.inputs-compact .input textarea { padding: 6px; font-size: 14px; }
.input label { display: block; font-size: 12px; color: var(--muted); margin-bottom: 4px; }
.input input, .input textarea { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--text); }
.actions { display: flex; gap: 10px; align-items: center; margin-top: 8px; }
.btn { background: #0f1515; border: 1px solid var(--border); color: var(--text); padding: 10px 14px; border-radius: 10px; cursor: pointer; min-height: 40px; font-size: 15px; transition: background-color .15s ease, border-color .15s ease, transform .05s ease; }
.btn-small { padding: 6px 10px; min-height: 30px; font-size: 13px; }
.btn-large { padding: 12px 18px; min-height: 48px; font-size: 16px; }
.btn-primary { background: var(--accent); border-color: var(--accent); color: #fff; }
.btn:hover { border-color: var(--accent); }
.btn-secondary { background: #1b2323; border-color: #2a3434; color: var(--text); }
.light .btn-secondary { background: #e5e7eb; border-color: #cbd5e1; color: #101314; }
.btn-danger { background: #a23b4c; border-color: #7a2634; color: #fff; }
.btn-success { background: #198e84; border-color: #0f766e; color: #fff; }
.btn-gold { background: #DAA520; border-color: #b8860b; color: #101314; }
.light .btn-gold { background: #e3b94a; border-color: #c08f22; color: #101314; }
.btn-success:hover, .btn-danger:hover { filter: brightness(1.05); }
.btn-gold:hover { filter: brightness(1.04); }
.session-controls { display: grid; grid-template-columns: 1fr auto 1fr; gap: 12px; align-items: center; margin-top: 16px; }
.session-controls .btn-prev { justify-self: start; }
.session-controls .btn-complete { justify-self: center; background: var(--accent); border-color: var(--accent); color: #fff; }
.session-controls .btn-next { justify-self: end; }
.session-controls .btn { font-weight: 600; }
.session-controls .btn-prev, .session-controls .btn-next { min-width: 120px; }
.session-controls .btn-complete { min-width: 180px; }
.timer { position: sticky; top: 0; z-index: 6; background: var(--bg); border-bottom: 1px solid var(--border); margin: 0 0 8px; }
.timer-bar { display: flex; align-items: center; justify-content: space-between; gap: 12px; padding: 8px 0; }
.timer-actions { display: flex; gap: 8px; align-items: center; }
.timer-display { font-size: 20px; }
.timer-panel { background: var(--card); border: 1px solid var(--border); padding: 10px; border-radius: 10px; margin: 8px 0 0; }
/* Fullscreen timer styles */
#timer:fullscreen { position: fixed; inset: 0; z-index: 999; background: var(--bg); padding: 16px; display: flex; flex-direction: column; justify-content: center; align-items: center; }
#timer:fullscreen .timer-bar { justify-content: center; width: 100%; flex-direction: column; align-items: center; gap: 12px; }
#timer:fullscreen .timer-actions { order: 1; }
#timer:fullscreen .timer-display { font-size: 24vmin; line-height: 1; text-align: center; }
#timer:fullscreen .timer-display { order: 2; }
#timer:fullscreen .timer-panel { max-width: 720px; margin: 12px auto 0; width: 100%; }
/* Immersive (fallback for iOS) */
.timer-immersive { position: fixed; inset: 0; z-index: 999; background: var(--bg); padding: 16px; overflow: auto; display: flex; flex-direction: column; justify-content: center; align-items: center; }
.timer-immersive .timer-bar { justify-content: center; width: 100%; flex-direction: column; align-items: center; gap: 12px; }
.timer-immersive .timer-actions { order: 1; }
.timer-immersive .timer-display { font-size: 24vmin; line-height: 1; text-align: center; }
.timer-immersive .timer-display { order: 2; }
.timer-immersive .timer-panel { max-width: 720px; margin: 12px auto 0; width: 100%; }

/* Pulse animation for vibration fallback */
@keyframes pulse-bg {
  0%, 100% { background-color: var(--bg); }
  50% { background-color: rgba(15,118,110,0.25); }
}
.timer-pulse { animation: pulse-bg 0.8s ease-in-out 1; }
.chart { display: grid; gap: 10px; }
.chart-row { display: grid; grid-template-columns: 32px 1fr 32px; gap: 8px; align-items: center; }
.chart-bar-wrap { background: #0f1515; border: 1px solid var(--border); border-radius: 10px; height: 16px; }
.chart-bar { background: var(--accent); height: 100%; border-radius: 10px; }
/* Sessão progress */
.session-bar { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; position: sticky; top: 52px; z-index: 5; background: var(--bg); padding: 8px 0; border-bottom: 1px solid var(--border); box-shadow: 0 2px 0 rgba(0,0,0,0.04); }
.progress { flex: 1; height: 12px; background: #0f1515; border: 1px solid var(--border); border-radius: 999px; min-width: 160px; margin: 6px 0 12px; overflow: hidden; }
.progress > span { display: block; height: 100%; background: var(--accent); border-radius: 10px; width: 0%; }
/* Resumo action bar */
.summary-bar { display: flex; gap: 8px; align-items: center; justify-content: flex-end; margin-bottom: 8px; flex-wrap: wrap; }
/* Sessão card width */
.session-card { max-width: 720px; margin: 0 auto; }
/* Spacing between meta and controls in Session */
.session-card .meta { margin-bottom: 8px; display: flex; flex-wrap: wrap; gap: 6px 10px; }
.session-card .meta span + span::before { content: '•'; margin: 0 6px 0 2px; color: var(--muted); }
/* Compact input heights for Session */
.session-card .inputs-compact .input input { height: 34px; }
/* Badge */
.badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 11px; line-height: 1; background: var(--accent); color: #fff; border: 1px solid var(--accent); }
.badge-secondary { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 11px; line-height: 1; background: #1b2323; color: var(--text); border: 1px solid var(--border); }
.light .badge-secondary { background: #eef2f7; color: #101314; border-color: #cbd5e1; }
/* Calculadora de anilhas */
.calc-wrap { margin-top: 8px; }
.calc-panel { background: #0f1515; border: 1px solid var(--border); border-radius: 10px; padding: 10px; margin-top: 8px; }
.calc-panel .row { display: grid; grid-template-columns: 140px 1fr; gap: 8px; align-items: center; margin-bottom: 8px; }
.calc-panel label { font-size: 12px; color: var(--muted); }
.calc-panel input, .calc-panel select { width: 100%; padding: 6px; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--text); }
.calc-panel .result { font-size: 13px; color: var(--text); }
@media (max-width: 768px) {
  .session-controls { grid-template-columns: 1fr; }
  .session-controls .btn-prev,
  .session-controls .btn-next,
  .session-controls .btn-complete { justify-self: stretch; }
  .timer { top: 0; }
  .timer-panel { width: 100%; position: static; }
  /* Empilhar ações do timer acima do tempo em telas menores */
  .timer .timer-bar { flex-direction: column; align-items: center; gap: 8px; }
  .timer .timer-actions { order: 1; }
  .timer .timer-display { order: 2; }
  /* Tabs ligeiramente maiores no mobile */
  .tab-btn { padding: 8px 12px; min-height: 40px; font-size: 14px; }
  /* Resumo: evitar overflow horizontal e reduzir margens */
  .summary-bar { justify-content: space-between; gap: 6px; }
  .summary-bar label { margin-left: 0 !important; }
}
/* Session title sizing */
.session-card h3 { font-size: 18px; margin-top: 0; margin-bottom: 8px; }
/* Buttons polish */
.btn:focus-visible { outline: none; box-shadow: 0 0 0 2px rgba(15,118,110,0.5); }
.btn:active { transform: translateY(1px); }
.btn:disabled { opacity: 0.6; cursor: default; filter: grayscale(12%); }
.btn-success:disabled { background: #1ea298; border-color: #128d85; color: #f8fafc; opacity: 0.8; filter: none; }
.btn-danger:disabled { background: #b45666; border-color: #8c3947; color: #fff; opacity: 0.8; filter: none; }
.btn-gold:disabled { background: #dcb653; border-color: #bf982e; color: #3b3b3b; opacity: 0.9; filter: none; }
.btn-secondary:disabled { background: #232c2c; border-color: #333d3d; color: var(--muted); opacity: 0.85; filter: none; }
.light .btn-secondary:disabled { background: #eef2f7; border-color: #d7dee6; color: #6b7280; opacity: 0.9; filter: none; }
.session-controls .btn-complete:hover { filter: brightness(1.05); }
/* Two-line button labels */
.btn .btn-title { display: block; font-weight: 700; line-height: 1.1; margin-bottom: 0; }
.btn .btn-sub { display: block; font-size: inherit; line-height: 1.1; font-weight: 700; color: #fff; }
.btn { white-space: normal; }
.light .btn .btn-sub { color: #fff; }
